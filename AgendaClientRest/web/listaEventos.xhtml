<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Lista de eventos</title>
    </h:head>
    <h:body>
        <h:form>    
        <h:commandButton id="Salir" value="Salir" action="#{agendaRestManagedBean.salir()}" />
        </h:form>
        <br/>
        <h:form>    
            <h:inputText id="hi" value="#{agendaRestManagedBean.email}" ></h:inputText>
            <h:commandButton id="VerPerfil" value="Ver Perfil" action="#{agendaRestManagedBean.verPerfil()}" rendered="#{agendaRestManagedBean.usuarioSeleccionado != null}"/>
        </h:form>   
        <f:view>
            <h:form id="listaEventos">
                <h1><h:outputText value="List"/></h1>
                <h:dataTable value="#{agendaRestManagedBean.listarEventos()}" var="item">
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Id"/>
                        </f:facet>
                        <h:outputText value="#{item.id}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Fechainicio"/>
                        </f:facet>
                        <h:outputText value="#{item.fechainicio}">
                            <f:convertDateTime pattern="MM/dd/yyyy" />
                        </h:outputText>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Fechafin"/>
                        </f:facet>
                        <h:outputText value="#{item.fechafin}">
                            <f:convertDateTime pattern="MM/dd/yyyy" />
                        </h:outputText>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Descripcion"/>
                        </f:facet>
                        <h:outputText value="#{item.descripcion}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Localizacion"/>
                        </f:facet>
                        <h:outputText value="#{item.localizacion}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Codigopostal"/>
                        </f:facet>
                        <h:outputText value="#{item.codigopostal}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Precio"/>
                        </f:facet>
                        <h:outputText value="#{item.precio}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Url"/>
                        </f:facet>
                        <h:outputText value="#{item.url}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Estado"/>
                        </f:facet>
                        <h:outputText value="#{item.estado}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Palabrasclave"/>
                        </f:facet>
                        <h:outputText value="#{item.palabrasclave}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Emailusuario"/>
                        </f:facet>
                        <h:outputText value="#{item.emailusuario.email.toString()}"/>
                    </h:column>
                    <h:column>
                        
                        <h:commandButton id="VerEvento" value="VerEvento" action="#{agendaRestManagedBean.verEvento(item)}" />
                    </h:column>
                    <h:column>
                        
                        <h:commandButton id="Modificar" value="Modificar" action="#{agendaRestManagedBean.modificarEvento(item)}" rendered="#{agendaRestManagedBean.usuarioSeleccionado.tipoUsuario == 3}" />
                    </h:column>
                    <h:column>
                        
                        <h:commandButton id="Eliminar" value="Eliminar" action="#{agendaRestManagedBean.eliminarEvento(item)}" rendered="#{agendaRestManagedBean.usuarioSeleccionado.tipoUsuario == 3}">
                            <f:ajax execute="@form" render="listaEventos"/>
                        </h:commandButton>
                    </h:column>
                    
                </h:dataTable>
                
                <h:commandButton id="CrearEvento" value="Crear Evento" action="#{agendaRestManagedBean.crearEvento()}" />
                <h:commandButton id="Validar" value="Validar" action="#{agendaRestManagedBean.verEventosSinValidar()}" rendered="#{agendaRestManagedBean.usuarioSeleccionado.tipoUsuario == 3}"/>
                
            </h:form>
        </f:view>
      <script type="text/javascript">
      function handleClientLoad() {
        gapi.load('client:auth2', initClient);
      }

      function initClient() {
        gapi.client.init({
            apiKey: 'AIzaSyDLCymEwbiWgB67Ly9fvBECL8W8sw5ode8',
            discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/plus/v1/rest'],
            clientId: '208840706342-38re9h49c7jkco0agfo4r1h95cdf13bk.apps.googleusercontent.com',
            scope: 'email https://www.googleapis.com/auth/plus.me'
        }).then(function () {
        });
      }

      function handleSignOutClick(event) {
          gapi.auth2.getAuthInstance().disconnect();
        gapi.auth2.getAuthInstance().signOut();
      }
    </script>
            <script src="https://apis.google.com/js/api.js"
      onload="this.onload=function(){};handleClientLoad()"
      onreadystatechange="if (this.readyState === 'complete') this.onload()">
    </script>
    </h:body>
</html>

